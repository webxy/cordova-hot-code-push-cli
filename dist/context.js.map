{"version":3,"sources":["../src/context.js"],"names":[],"mappings":";;AAAA,CAAC,YAAW;;AAEV,MAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAC3B,MAAI,EAAE,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AAC7B,MAAI,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;AAC1B,MAAI,yBAAyB,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,aAAa,CAAC,CAAC;AACxE,MAAI,kBAAkB,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,KAAK,CAAC,CAAC;AACzD,MAAI,kBAAkB,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,kBAAkB,CAAC,CAAC;AACtE,MAAI,mBAAmB,GAAG,CACtB,WAAW,EACX,gBAAgB,EAChB,iBAAiB,EACjB,WAAW,EACX,eAAe,EACf,QAAQ,EACR,YAAY,EACZ,UAAU,EACV,MAAM,EACN,cAAc,CAAC,CAAC;;AAEpB,QAAM,CAAC,OAAO,GAAG;AACf,WAAO,EAAG,OAAO;GAClB,CAAC;;AAEF,WAAS,OAAO,CAAC,IAAI,EAAE;AACrB,WAAO,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC;GAC1B;;AAED,MAAI,OAAO,GAAG,SAAV,OAAO,CAAY,IAAI,EAAE;AAC3B,QAAI,CAAC,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,EAAE,CAAC;AAC7B,QAAI,CAAC,aAAa,GAAG,kBAAkB,CAAC;AACxC,QAAI,CAAC,eAAe,GAAG,kBAAkB,CAAC,IAAI,CAAC,CAAC;AAChD,QAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,eAAe,CAAC,CAAC;AACzE,QAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,WAAW,CAAC,CAAC;AAC3E,QAAI,CAAC,YAAY,GAAG,eAAe,EAAE,CAAC;GACvC,CAAC;;AAEF,WAAS,kBAAkB,CAAC,IAAI,EAAE;AAChC,QAAI,WAAW,GAAG,IAAI,CAAC,CAAC,CAAC;AACzB,QAAI,CAAC,WAAW,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE;AAC5C,aAAO,kBAAkB,CAAC;KAC3B;;AAED,WAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;GACjD;;AAED,WAAS,eAAe,GAAG;AACzB,QAAI,aAAa,GAAG,6BAA6B,CAAC,yBAAyB,CAAC,CAAC;AAC7E,QAAI,WAAW,GAAG,CAAC,CAAC,KAAK,CAAC,mBAAmB,EAAE,aAAa,CAAC,CAAC;;;AAG9D,KAAC,CAAC,MAAM,CAAC,WAAW,EAAE,UAAS,IAAI,EAAE;AACnC,aAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;KAC7D,CAAC,CAAC;;AAEH,WAAO,WAAW,CAAC;GACpB;;AAED,WAAS,6BAA6B,CAAC,YAAY,EAAE;AACnD,QAAI,WAAW,CAAC;AAChB,QAAI;AACF,iBAAW,GAAG,EAAE,CAAC,YAAY,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;KACrD,CAAC,OAAO,CAAC,EAAE;AACV,aAAO,EAAE,CAAC;KACX;;AAED,WAAO,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;GACxC;CAEF,CAAA,EAAG,CAAC","file":"context.js","sourcesContent":["(function() {\n\n  var path = require('path');\n  var fs = require('fs-extra');\n  var _ = require('lodash');\n  var IGNORED_FILES_CONFIG_PATH = path.join(process.cwd(), '.chcpignore');\n  var DEFAULT_WWW_FOLDER = path.join(process.cwd(), 'www');\n  var DEFAULT_CLI_CONFIG = path.join(process.cwd(), 'cordova-hcp.json');\n  var DEFAULT_IGNORE_LIST = [\n      '.DS_Store',\n      'node_modules/*',\n      'node_modules\\\\*',\n      'chcp.json',\n      'chcp.manifest',\n      '.chcp*',\n      '.gitignore',\n      '.gitkeep',\n      '.git',\n      'package.json'];\n\n  module.exports = {\n    context : context\n  };\n\n  function context(argv) {\n    return new Context(argv);\n  }\n\n  var Context = function(argv) {\n    this.argv = argv ? argv : {};\n    this.defaultConfig = DEFAULT_CLI_CONFIG;\n    this.sourceDirectory = getSourceDirectory(argv);\n    this.manifestFilePath = path.join(this.sourceDirectory, 'chcp.manifest');\n    this.projectsConfigFilePath = path.join(this.sourceDirectory, 'chcp.json');\n    this.ignoredFiles = getIgnoredFiles();\n  };\n\n  function getSourceDirectory(argv) {\n    var consoleArgs = argv._;\n    if (!consoleArgs || consoleArgs.length !== 2) {\n      return DEFAULT_WWW_FOLDER;\n    }\n\n    return path.join(process.cwd(), consoleArgs[1]);\n  }\n\n  function getIgnoredFiles() {\n    var projectIgnore = readIgnoredFilesProjectConfig(IGNORED_FILES_CONFIG_PATH);\n    var ignoredList = _.union(DEFAULT_IGNORE_LIST, projectIgnore);\n\n    // remove comments and empty items\n    _.remove(ignoredList, function(item) {\n      return item.indexOf('#') === 0 || _.trim(item).length === 0;\n    });\n\n    return ignoredList;\n  }\n\n  function readIgnoredFilesProjectConfig(pathToConfig) {\n    var fileContent;\n    try {\n      fileContent = fs.readFileSync(pathToConfig, 'utf8');\n    } catch (e) {\n      return [];\n    }\n\n    return _.trim(fileContent).split(/\\n/);\n  }\n\n})();\n"]}